<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For All of Tracy - Results</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" type="text/css" href="../static/custom.css">
</head>
<body>
    <a href="/" class="fs-4 ms-3 mt-2 position-fixed return-btn">  Back  </a>
    <div class="vw-100 vh-100 d-flex justify-content-center align-items-center flex-column">
        <h2 id="form-title" class="mb-4">Request a Business Form</h2>
        <div class="card" style="height: 50rem">
            <div class="card-body d-flex flex-column" style="width: 40rem; overflow-y: scroll" id="search-results-container">
                <form id="BusinessF" action="/businessForm" enctype="multipart/form-data" method="POST">
                    <h4>Business Information</h4>
                    <div class="form-floating mb-3">
                        <input id="businessName" type="text" class="form-control" placeholder="Business Name"  name="businessName" required>
                        <label for="businessName">Business Name <span class="required-field"></span></label>
                    </div>
                    <div class="form-floating mb-3">
                        <input id="businessType" type="text" class="form-control" placeholder="Business Type" name="businessType" required>
                        <label for="businessLocation">Business Type <span class="required-field"></span></label>
                    </div>
                    <div class="form-floating mb-3">
                        <input id="businessHours" type="text" class="form-control" placeholder="Business Hours" name="businessHours" required>
                        <label for="businessLocation">Business Hours<span class="required-field"></span></label>
                    </div>
                    <div class="form-floating mb-3">
                        <input id="businessLocation" type="text" class="form-control" placeholder="Business Location" name="businessLocation" required>
                        <label for="businessLocation">Business Location <span class="required-field"></span></label>
                    </div>
                    <div class="input-group mb-3">
                        <button
                            class="btn btn-outline-secondary dropdown-toggle"
                            type="button"
                            data-bs-toggle="dropdown"
                            aria-expanded="false"
                        >
                            Pick A Community
                        </button>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#" data-value="Tracy Hills">Tracy Hills</a></li>
                            <li><a class="dropdown-item" href="#" data-value="Ellis">Ellis</a></li>
                            <li><a class="dropdown-item" href="#" data-value="Edgewood">Edgewood</a></li>
                            <li><a class="dropdown-item" href="#" data-value="Redbridge">Redbridge</a></li>
                        </ul>
                        <!-- Hidden Input for Community -->
                        <input  id="community" type="text" class="form-control" name="community"  placeholder="Selected Community " readonly>
                    </div>
                
                    <!-- Business Location Input -->
            
                    <h4>Business License <span class="required-field"></span></h4>
                    <div class="input-group mb-3">
                        <input type="file" class="form-control" id="inputGroupFile02" name="business_license" required>
                        <label class="input-group-text" for="inputGroupFile02">Upload </label>
                    </div>
                      
                    <h4>Contact Information</h4>
                    <div class="form-floating mb-3">
                        <input id="ownerName" type="text" class="form-control" placeholder="Owner Name" name="ownername" required> 
                        <label for="ownerName">Owner Name<span class="required-field"></span></label>
                    </div>
                    <div class="form-floating mb-3">
                        <input id="email" type="email" class="form-control" placeholder="Email" name="email" required>
                        <label for="email">Email<span class="required-field"></span></label>
                    </div>
                    <div class="form-floating mb-3">
                        <input id="phoneNumber" type="tel"  class="form-control" placeholder="Phone Number" name="phoneNumber" required pattern="^\(\d{3}\)\s\d{3}-\d{4}$" required>
                        <label for="phoneNumber">Phone Number <span class="required-field"></span></label>
                    </div> <!-- Close the div properly here -->
                    <button class="btn btn-primary" type="submit">Submit</button>
            </form>
            <div id="modalOverlay"></div>
            <div id="successModal">
                <p>Form submission completed successfully!</p>
                <button onclick="closeModal()">OK</button>
            </div>

            <script>
                const form = document.getElementById("BusinessF");
                const modal = document.getElementById("successModal");
                const overlay = document.getElementById("modalOverlay");
                const body = document.body;

                form.addEventListener("submit", function (event) {
                    // Prevent default form submission
                    event.preventDefault();

                    // Show the modal and overlay
                    modal.style.display = "block";
                    overlay.style.display = "block";

                    // Add class to prevent page scrolling
                    body.classList.add("modal-open");
                });

                function closeModal() {
                    // Hide the modal and overlay
                    modal.style.display = "none";
                    overlay.style.display = "none";

                    // Remove class to re-enable page scrolling
                    body.classList.remove("modal-open");

                    // Optionally submit the form after closing the modal
                    form.submit();
                }
            </script>
             <script>
                const phoneInput = document.getElementById('phoneNumber');
            
                function formatPhoneNumber(value) {
                  // Remove all non-digit characters
                  const numbers = value.replace(/\D/g, '');
            
                  // Format the phone number as (123) 456-789
                  const match = numbers.match(/^(\d{0,3})(\d{0,3})(\d{0,4})$/);
            
                  if (match) {
                    const part1 = match[1] ? `(${match[1]}` : '';
                    const part2 = match[2] ? `) ${match[2]}` : '';
                    const part3 = match[3] ? `-${match[3]}` : '';
                    return `${part1}${part2}${part3}`;
                  }
            
                  return value; // Return unformatted value if no match
                }
            
                phoneInput.addEventListener('input', (event) => {
                  const formatted = formatPhoneNumber(event.target.value);
                  phoneInput.value = formatted;
                });
            
                // Handle autofill or paste events
                phoneInput.addEventListener('blur', () => {
                  phoneInput.value = formatPhoneNumber(phoneInput.value);
                });
              </script>
                </div>
            </div>
        </div>
    </div>
    <script src="../static/businessForm.js" type="text/javascript"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Get all dropdown items and the community input field
        const dropdownItems = document.querySelectorAll('.dropdown-item');
        const communityInput = document.getElementById('community');
    
        // Update community input field when a dropdown item is clicked
        dropdownItems.forEach(item => {
            item.addEventListener('click', event => {
                event.preventDefault(); // Prevent default behavior
                const selectedValue = item.getAttribute('data-value'); // Get the value from the dropdown
                communityInput.value = selectedValue; // Update the input field
            });
        });
    </script>
    
</body>
</html>